using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Security.Cryptography.X509Certificates;
using System.Text;
using System.Text.Json.Serialization;
using System.Threading.Tasks;
using System.Xml;

namespace AdventOfCode
{
    public class D5
    {
        public Dictionary<int, List<int>> m_dict;
        public List<List<int>> m_list;
        public List<int> m_WrongOrder;
        public D5()
        {
            List<List<int>> list = new List<List<int>>();
            Dictionary<int, List<int>> dict = new Dictionary<int, List<int>>();
            string str = "24|55\r\n38|32\r\n38|21\r\n48|51\r\n48|92\r\n48|14\r\n78|35\r\n78|54\r\n78|87\r\n78|44\r\n72|29\r\n72|65\r\n72|87\r\n72|82\r\n72|37\r\n23|56\r\n23|51\r\n23|81\r\n23|83\r\n23|25\r\n23|87\r\n25|14\r\n25|18\r\n25|55\r\n25|22\r\n25|15\r\n25|77\r\n25|17\r\n54|96\r\n54|65\r\n54|33\r\n54|21\r\n54|36\r\n54|29\r\n54|56\r\n54|89\r\n56|78\r\n56|88\r\n56|77\r\n56|52\r\n56|22\r\n56|81\r\n56|14\r\n56|85\r\n56|17\r\n33|23\r\n33|22\r\n33|83\r\n33|14\r\n33|89\r\n33|25\r\n33|55\r\n33|92\r\n33|72\r\n33|78\r\n96|78\r\n96|21\r\n96|14\r\n96|77\r\n96|92\r\n96|68\r\n96|88\r\n96|24\r\n96|83\r\n96|55\r\n96|91\r\n97|56\r\n97|54\r\n97|17\r\n97|43\r\n97|13\r\n97|33\r\n97|48\r\n97|96\r\n97|65\r\n97|89\r\n97|83\r\n97|37\r\n35|92\r\n35|23\r\n35|25\r\n35|52\r\n35|24\r\n35|33\r\n35|51\r\n35|21\r\n35|55\r\n35|88\r\n35|17\r\n35|56\r\n35|89\r\n52|44\r\n52|61\r\n52|88\r\n52|82\r\n52|64\r\n52|71\r\n52|51\r\n52|99\r\n52|97\r\n52|68\r\n52|85\r\n52|91\r\n52|18\r\n52|55\r\n22|43\r\n22|61\r\n22|72\r\n22|68\r\n22|15\r\n22|87\r\n22|64\r\n22|85\r\n22|97\r\n22|88\r\n22|51\r\n22|71\r\n22|18\r\n22|63\r\n22|91\r\n29|14\r\n29|81\r\n29|35\r\n29|89\r\n29|96\r\n29|21\r\n29|13\r\n29|36\r\n29|23\r\n29|65\r\n29|48\r\n29|17\r\n29|24\r\n29|52\r\n29|33\r\n29|99\r\n65|17\r\n65|15\r\n65|25\r\n65|48\r\n65|56\r\n65|22\r\n65|52\r\n65|21\r\n65|92\r\n65|23\r\n65|36\r\n65|83\r\n65|24\r\n65|55\r\n65|37\r\n65|89\r\n65|81\r\n36|77\r\n36|96\r\n36|83\r\n36|99\r\n36|56\r\n36|89\r\n36|68\r\n36|21\r\n36|55\r\n36|92\r\n36|78\r\n36|88\r\n36|51\r\n36|72\r\n36|52\r\n36|14\r\n36|24\r\n36|17\r\n32|24\r\n32|83\r\n32|13\r\n32|29\r\n32|21\r\n32|25\r\n32|92\r\n32|56\r\n32|33\r\n32|99\r\n32|96\r\n32|14\r\n32|35\r\n32|22\r\n32|88\r\n32|17\r\n32|65\r\n32|81\r\n32|37\r\n64|42\r\n64|48\r\n64|37\r\n64|96\r\n64|44\r\n64|56\r\n64|71\r\n64|76\r\n64|36\r\n64|29\r\n64|33\r\n64|23\r\n64|65\r\n64|13\r\n64|25\r\n64|38\r\n64|43\r\n64|32\r\n64|97\r\n64|54\r\n55|64\r\n55|76\r\n55|61\r\n55|43\r\n55|38\r\n55|87\r\n55|71\r\n55|72\r\n55|54\r\n55|68\r\n55|18\r\n55|67\r\n55|85\r\n55|63\r\n55|51\r\n55|78\r\n55|77\r\n55|44\r\n55|15\r\n55|97\r\n55|91\r\n43|14\r\n43|96\r\n43|32\r\n43|89\r\n43|48\r\n43|35\r\n43|23\r\n43|36\r\n43|83\r\n43|24\r\n43|33\r\n43|52\r\n43|56\r\n43|65\r\n43|13\r\n43|25\r\n43|21\r\n43|17\r\n43|54\r\n43|76\r\n43|42\r\n43|37\r\n92|85\r\n92|71\r\n92|38\r\n92|77\r\n92|64\r\n92|76\r\n92|44\r\n92|51\r\n92|63\r\n92|68\r\n92|87\r\n92|55\r\n92|88\r\n92|18\r\n92|99\r\n92|15\r\n92|72\r\n92|97\r\n92|43\r\n92|82\r\n92|61\r\n92|91\r\n92|78\r\n17|18\r\n17|81\r\n17|82\r\n17|52\r\n17|92\r\n17|77\r\n17|64\r\n17|21\r\n17|14\r\n17|68\r\n17|51\r\n17|83\r\n17|99\r\n17|24\r\n17|91\r\n17|72\r\n17|88\r\n17|15\r\n17|87\r\n17|85\r\n17|55\r\n17|22\r\n17|67\r\n17|78\r\n83|68\r\n83|77\r\n83|18\r\n83|99\r\n83|67\r\n83|51\r\n83|15\r\n83|72\r\n83|92\r\n83|22\r\n83|82\r\n83|85\r\n83|88\r\n83|63\r\n83|78\r\n83|44\r\n83|52\r\n83|24\r\n83|91\r\n83|55\r\n83|87\r\n83|61\r\n83|14\r\n83|64\r\n76|25\r\n76|14\r\n76|56\r\n76|22\r\n76|89\r\n76|23\r\n76|42\r\n76|35\r\n76|83\r\n76|29\r\n76|48\r\n76|32\r\n76|81\r\n76|33\r\n76|96\r\n76|13\r\n76|65\r\n76|21\r\n76|36\r\n76|52\r\n76|24\r\n76|17\r\n76|37\r\n76|54\r\n67|32\r\n67|71\r\n67|33\r\n67|25\r\n67|56\r\n67|97\r\n67|42\r\n67|43\r\n67|38\r\n67|37\r\n67|64\r\n67|29\r\n67|76\r\n67|35\r\n67|48\r\n67|44\r\n67|36\r\n67|82\r\n67|54\r\n67|23\r\n67|61\r\n67|63\r\n67|65\r\n67|13\r\n71|25\r\n71|48\r\n71|29\r\n71|33\r\n71|96\r\n71|42\r\n71|17\r\n71|89\r\n71|97\r\n71|35\r\n71|37\r\n71|54\r\n71|23\r\n71|43\r\n71|83\r\n71|36\r\n71|21\r\n71|13\r\n71|38\r\n71|76\r\n71|81\r\n71|65\r\n71|56\r\n71|32\r\n42|22\r\n42|35\r\n42|29\r\n42|24\r\n42|92\r\n42|36\r\n42|32\r\n42|99\r\n42|89\r\n42|14\r\n42|48\r\n42|65\r\n42|56\r\n42|17\r\n42|37\r\n42|96\r\n42|23\r\n42|25\r\n42|13\r\n42|21\r\n42|52\r\n42|81\r\n42|33\r\n42|83\r\n51|67\r\n51|78\r\n51|61\r\n51|71\r\n51|63\r\n51|97\r\n51|42\r\n51|87\r\n51|72\r\n51|77\r\n51|18\r\n51|29\r\n51|15\r\n51|64\r\n51|85\r\n51|82\r\n51|44\r\n51|43\r\n51|68\r\n51|54\r\n51|38\r\n51|76\r\n51|91\r\n51|32\r\n85|61\r\n85|67\r\n85|76\r\n85|25\r\n85|37\r\n85|33\r\n85|36\r\n85|32\r\n85|23\r\n85|97\r\n85|43\r\n85|63\r\n85|38\r\n85|35\r\n85|13\r\n85|48\r\n85|29\r\n85|44\r\n85|64\r\n85|82\r\n85|65\r\n85|42\r\n85|54\r\n85|71\r\n81|82\r\n81|72\r\n81|52\r\n81|87\r\n81|91\r\n81|15\r\n81|14\r\n81|83\r\n81|92\r\n81|22\r\n81|78\r\n81|68\r\n81|77\r\n81|18\r\n81|24\r\n81|67\r\n81|51\r\n81|85\r\n81|64\r\n81|99\r\n81|88\r\n81|55\r\n81|61\r\n81|21\r\n63|29\r\n63|44\r\n63|38\r\n63|89\r\n63|36\r\n63|48\r\n63|25\r\n63|33\r\n63|96\r\n63|17\r\n63|81\r\n63|32\r\n63|43\r\n63|42\r\n63|35\r\n63|37\r\n63|13\r\n63|76\r\n63|56\r\n63|97\r\n63|54\r\n63|65\r\n63|71\r\n63|23\r\n37|22\r\n37|56\r\n37|99\r\n37|36\r\n37|33\r\n37|78\r\n37|92\r\n37|23\r\n37|52\r\n37|14\r\n37|24\r\n37|55\r\n37|13\r\n37|48\r\n37|25\r\n37|81\r\n37|89\r\n37|83\r\n37|21\r\n37|96\r\n37|15\r\n37|17\r\n37|88\r\n37|51\r\n15|67\r\n15|61\r\n15|29\r\n15|77\r\n15|76\r\n15|68\r\n15|97\r\n15|71\r\n15|85\r\n15|32\r\n15|64\r\n15|63\r\n15|54\r\n15|35\r\n15|87\r\n15|91\r\n15|38\r\n15|43\r\n15|78\r\n15|42\r\n15|44\r\n15|82\r\n15|18\r\n15|72\r\n82|71\r\n82|54\r\n82|36\r\n82|65\r\n82|61\r\n82|63\r\n82|35\r\n82|96\r\n82|32\r\n82|33\r\n82|48\r\n82|76\r\n82|97\r\n82|56\r\n82|29\r\n82|43\r\n82|89\r\n82|23\r\n82|38\r\n82|25\r\n82|42\r\n82|37\r\n82|44\r\n82|13\r\n88|42\r\n88|78\r\n88|71\r\n88|15\r\n88|44\r\n88|54\r\n88|51\r\n88|85\r\n88|97\r\n88|43\r\n88|72\r\n88|91\r\n88|76\r\n88|87\r\n88|18\r\n88|64\r\n88|82\r\n88|63\r\n88|77\r\n88|38\r\n88|67\r\n88|68\r\n88|55\r\n88|61\r\n14|85\r\n14|77\r\n14|68\r\n14|87\r\n14|55\r\n14|67\r\n14|44\r\n14|99\r\n14|22\r\n14|91\r\n14|92\r\n14|61\r\n14|38\r\n14|64\r\n14|71\r\n14|15\r\n14|72\r\n14|52\r\n14|51\r\n14|82\r\n14|63\r\n14|78\r\n14|88\r\n14|18\r\n18|65\r\n18|64\r\n18|71\r\n18|38\r\n18|33\r\n18|63\r\n18|43\r\n18|61\r\n18|67\r\n18|91\r\n18|37\r\n18|13\r\n18|82\r\n18|29\r\n18|48\r\n18|97\r\n18|44\r\n18|42\r\n18|23\r\n18|35\r\n18|85\r\n18|54\r\n18|76\r\n18|32\r\n77|54\r\n77|68\r\n77|97\r\n77|63\r\n77|67\r\n77|85\r\n77|37\r\n77|42\r\n77|38\r\n77|61\r\n77|72\r\n77|18\r\n77|65\r\n77|29\r\n77|44\r\n77|35\r\n77|91\r\n77|82\r\n77|43\r\n77|71\r\n77|32\r\n77|76\r\n77|87\r\n77|64\r\n44|38\r\n44|35\r\n44|25\r\n44|36\r\n44|29\r\n44|33\r\n44|89\r\n44|76\r\n44|56\r\n44|37\r\n44|23\r\n44|48\r\n44|96\r\n44|65\r\n44|97\r\n44|43\r\n44|54\r\n44|71\r\n44|17\r\n44|21\r\n44|81\r\n44|42\r\n44|32\r\n44|13\r\n21|61\r\n21|22\r\n21|14\r\n21|82\r\n21|72\r\n21|92\r\n21|91\r\n21|18\r\n21|15\r\n21|24\r\n21|87\r\n21|67\r\n21|83\r\n21|55\r\n21|85\r\n21|99\r\n21|77\r\n21|63\r\n21|68\r\n21|51\r\n21|88\r\n21|64\r\n21|52\r\n21|78\r\n87|37\r\n87|65\r\n87|64\r\n87|48\r\n87|67\r\n87|91\r\n87|33\r\n87|82\r\n87|29\r\n87|63\r\n87|54\r\n87|85\r\n87|42\r\n87|61\r\n87|76\r\n87|38\r\n87|97\r\n87|44\r\n87|35\r\n87|43\r\n87|32\r\n87|18\r\n87|13\r\n87|71\r\n89|87\r\n89|81\r\n89|92\r\n89|78\r\n89|15\r\n89|88\r\n89|64\r\n89|91\r\n89|17\r\n89|68\r\n89|24\r\n89|72\r\n89|77\r\n89|99\r\n89|55\r\n89|83\r\n89|22\r\n89|18\r\n89|14\r\n89|52\r\n89|21\r\n89|85\r\n89|51\r\n89|67\r\n61|63\r\n61|97\r\n61|33\r\n61|23\r\n61|65\r\n61|17\r\n61|35\r\n61|13\r\n61|56\r\n61|71\r\n61|44\r\n61|96\r\n61|42\r\n61|38\r\n61|37\r\n61|29\r\n61|76\r\n61|48\r\n61|32\r\n61|54\r\n61|36\r\n61|43\r\n61|89\r\n61|25\r\n91|65\r\n91|67\r\n91|44\r\n91|13\r\n91|76\r\n91|32\r\n91|61\r\n91|82\r\n91|63\r\n91|85\r\n91|29\r\n91|43\r\n91|36\r\n91|64\r\n91|48\r\n91|71\r\n91|38\r\n91|37\r\n91|33\r\n91|42\r\n91|97\r\n91|35\r\n91|23\r\n91|54\r\n68|87\r\n68|65\r\n68|63\r\n68|91\r\n68|38\r\n68|37\r\n68|61\r\n68|35\r\n68|54\r\n68|32\r\n68|82\r\n68|97\r\n68|18\r\n68|71\r\n68|13\r\n68|72\r\n68|64\r\n68|85\r\n68|44\r\n68|42\r\n68|29\r\n68|76\r\n68|43\r\n68|67\r\n99|91\r\n99|15\r\n99|38\r\n99|55\r\n99|72\r\n99|64\r\n99|77\r\n99|18\r\n99|97\r\n99|54\r\n99|76\r\n99|61\r\n99|78\r\n99|44\r\n99|71\r\n99|68\r\n99|82\r\n99|43\r\n99|51\r\n99|88\r\n99|85\r\n99|63\r\n99|67\r\n99|87\r\n13|15\r\n13|14\r\n13|99\r\n13|89\r\n13|17\r\n13|21\r\n13|25\r\n13|51\r\n13|56\r\n13|33\r\n13|48\r\n13|36\r\n13|78\r\n13|83\r\n13|77\r\n13|81\r\n13|24\r\n13|52\r\n13|88\r\n13|23\r\n13|22\r\n13|55\r\n13|92\r\n13|96\r\n24|18\r\n24|87\r\n24|77\r\n24|92\r\n24|52\r\n24|14\r\n24|44\r\n24|61\r\n24|22\r\n24|71\r\n24|82\r\n24|72\r\n24|78\r\n24|68\r\n24|64\r\n24|63\r\n24|51\r\n24|67\r\n24|88\r\n24|99\r\n24|15\r\n24|85\r\n24|91\r\n38|43\r\n38|65\r\n38|54\r\n38|42\r\n38|23\r\n38|33\r\n38|76\r\n38|83\r\n38|96\r\n38|25\r\n38|37\r\n38|48\r\n38|35\r\n38|81\r\n38|56\r\n38|97\r\n38|29\r\n38|13\r\n38|36\r\n38|89\r\n38|24\r\n38|17\r\n48|33\r\n48|83\r\n48|23\r\n48|78\r\n48|55\r\n48|81\r\n48|22\r\n48|77\r\n48|89\r\n48|25\r\n48|24\r\n48|21\r\n48|99\r\n48|36\r\n48|17\r\n48|96\r\n48|68\r\n48|56\r\n48|52\r\n48|15\r\n48|88\r\n78|68\r\n78|72\r\n78|77\r\n78|43\r\n78|64\r\n78|38\r\n78|61\r\n78|97\r\n78|71\r\n78|76\r\n78|42\r\n78|32\r\n78|85\r\n78|65\r\n78|91\r\n78|63\r\n78|82\r\n78|18\r\n78|67\r\n78|29\r\n72|32\r\n72|67\r\n72|97\r\n72|64\r\n72|61\r\n72|13\r\n72|42\r\n72|85\r\n72|76\r\n72|71\r\n72|91\r\n72|35\r\n72|18\r\n72|54\r\n72|48\r\n72|63\r\n72|43\r\n72|38\r\n72|44\r\n23|96\r\n23|68\r\n23|92\r\n23|99\r\n23|22\r\n23|14\r\n23|89\r\n23|72\r\n23|77\r\n23|17\r\n23|24\r\n23|55\r\n23|52\r\n23|15\r\n23|78\r\n23|88\r\n23|36\r\n23|21\r\n25|72\r\n25|51\r\n25|52\r\n25|21\r\n25|92\r\n25|78\r\n25|87\r\n25|91\r\n25|24\r\n25|88\r\n25|96\r\n25|83\r\n25|99\r\n25|81\r\n25|68\r\n25|89\r\n25|56\r\n54|83\r\n54|22\r\n54|81\r\n54|42\r\n54|48\r\n54|92\r\n54|24\r\n54|25\r\n54|13\r\n54|35\r\n54|52\r\n54|37\r\n54|32\r\n54|14\r\n54|23\r\n54|17\r\n56|68\r\n56|24\r\n56|99\r\n56|72\r\n56|15\r\n56|55\r\n56|51\r\n56|18\r\n56|21\r\n56|91\r\n56|87\r\n56|92\r\n56|83\r\n56|89\r\n56|96\r\n33|56\r\n33|99\r\n33|96\r\n33|52\r\n33|81\r\n33|88\r\n33|15\r\n33|36\r\n33|68\r\n33|77\r\n33|17\r\n33|51\r\n33|24\r\n33|21\r\n96|72\r\n96|52\r\n96|67\r\n96|51\r\n96|85\r\n96|81\r\n96|89\r\n96|87\r\n96|18\r\n96|17\r\n96|22\r\n96|15\r\n96|99\r\n97|42\r\n97|29\r\n97|14\r\n97|36\r\n97|81\r\n97|32\r\n97|23\r\n97|21\r\n97|35\r\n97|76\r\n97|24\r\n97|25\r\n35|65\r\n35|22\r\n35|99\r\n35|37\r\n35|13\r\n35|96\r\n35|81\r\n35|36\r\n35|14\r\n35|48\r\n35|83\r\n52|92\r\n52|15\r\n52|78\r\n52|63\r\n52|67\r\n52|22\r\n52|72\r\n52|38\r\n52|87\r\n52|77\r\n22|92\r\n22|78\r\n22|99\r\n22|82\r\n22|44\r\n22|67\r\n22|77\r\n22|38\r\n22|55\r\n29|55\r\n29|92\r\n29|56\r\n29|88\r\n29|22\r\n29|83\r\n29|25\r\n29|37\r\n65|14\r\n65|99\r\n65|88\r\n65|13\r\n65|51\r\n65|96\r\n65|33\r\n36|81\r\n36|87\r\n36|25\r\n36|15\r\n36|22\r\n36|18\r\n32|36\r\n32|48\r\n32|89\r\n32|23\r\n32|52\r\n64|82\r\n64|63\r\n64|61\r\n64|35\r\n55|32\r\n55|42\r\n55|82\r\n43|81\r\n43|29\r\n92|67\r\n\r\n42,54,21,36,22,33,13,29,35\r\n83,67,22,14,78,99,18,92,15,77,52,68,82,55,21,61,85,91,51,64,72,24,88\r\n85,67,64,82,61,63,44,71,38,97,43,54,42,32,29,35,65,37,13,48,33,23,36\r\n96,81,21,14,52,99,88,55,51,15,77,68,72,18,85\r\n63,52,77,85,91,83,22,61,14,64,82,68,51,24,55\r\n63,97,76,32,29,35,13,48,33,36,25,56,96,89,17\r\n15,99,51,88,21,83,72,56,81,18,92,52,55,17,89,96,87\r\n92,22,17,96,78,87,72,14,24,55,81,91,52,83,68,88,18,99,56\r\n87,18,61,67,64,76,72,85,97,65,91,68,32,44,29,43,37\r\n87,63,72,64,85,38,43,78,76,82,77,67,88,54,55\r\n51,77,87,85,67,61,63,44,97\r\n35,65,37,13,48,36,25,56,81,24,22,92,88\r\n85,29,32,42,35,87,43,13,63,37,71,72,82,76,91\r\n56,35,81,96,55,92,83\r\n54,68,67,77,61,18,63,76,82,55,97,15,42,91,51,38,85,43,72,87,71\r\n99,88,55,15,77,68,72,87,18,91,67,82,61,44,71,38,97,43,76\r\n14,17,81,91,55,22,21,87,64\r\n92,51,68,96,81,17,88,89,83,22,23,15,14,21,25,99,24,78,56,72,36,77,55\r\n68,87,18,85,82,44,71,43,76,54,42,32,29,35,37\r\n92,22,88,14,21,55,24,17,25,36,13,23,48\r\n92,25,18,68,88,51,17\r\n32,17,37,54,89,71,43,33,42,21,25\r\n33,36,25,56,96,89,17,81,83,24,14,52,22,92,99,55,51,15,78,77,68\r\n61,63,44,71,38,43,76,54,42,32,65,13,48,33,36,56,89\r\n14,88,51,87,64,44,71\r\n14,92,88,51,15,77,68,87,71\r\n42,21,89,83,35,65,81,24,23,32,33,13,29,14,52,25,17\r\n17,83,14,22,92,55,51,15,78,77,18,91,85,67,64\r\n21,83,22,18,92,67,15,99,64,85,68,87,55,91,78,51,88,77,14,61,52\r\n64,15,77,85,92,61,88,83,78,22,18,72,68,52,82,91,87,63,14,99,55\r\n89,21,76,35,96,83,17,13,38,25,54\r\n77,68,91,85,64,82,44,38,65\r\n54,64,91,38,63,51,71,61,85,97,44,18,67,76,43,72,78,15,32\r\n51,87,52,85,72,14,83,24,68,15,21,17,92\r\n21,83,99,96,36,17,52,81,56,65,25,14,48,13,24,92,55,23,89\r\n76,42,29,48,33,36,25,56,96,89,17,81,83\r\n77,55,22,78,87,64,61,88,67,68,71,72,51,44,52,82,99,15,14\r\n37,33,85,54,44,76,38,23,13,42,36\r\n43,25,29,13,33,38,35,97,48,56,65,32,17,54,89,81,44,37,36,23,71\r\n81,92,88,78,68,91,85,67,82\r\n56,81,21,24,14,88,55,51,77,68,91\r\n97,29,65,33,17,83,24\r\n38,33,56,43,61,35,76,54,64,32,36\r\n63,44,71,38,43,76,54,42,37,13,48,23,36\r\n22,17,96,89,14,92,83,37,99,88,29,21,52,48,23,81,35,24,36,13,25\r\n77,61,18,87,72,51,38\r\n24,92,99,55,51,85,44\r\n64,82,77,35,38\r\n87,51,15,88,67,52,18,82,72,77,99,71,64,22,44\r\n99,88,51,15,78,72,87,18,85,67,64,61,63,71,76\r\n23,36,25,56,96,17,81,83,14,52,92,88,55,51,78,68,72\r\n52,92,99,15,78,77,68,72,87,91,85,64,82,61,44,71,38\r\n13,23,17,14,99,55,78\r\n25,17,35,37,44,54,71,81,56,65,32\r\n38,64,55,52,87,77,71,99,88,68,18\r\n71,38,97,76,54,42,32,29,35,65,13,33,23,36,25,56,96,89,17,81,21\r\n82,91,52,83,21,18,14,77,85,61,92,64,88,51,68,99,78,22,24\r\n29,35,13,33,25,56,96,89,17,21,83,24,14,52,22,92,88\r\n91,61,14,88,18,15,55,99,82,77,64,92,78,87,71,68,51,85,72\r\n13,36,35,32,38,76,63,82,37,43,65,42,54,48,64,29,56,97,33\r\n61,88,71,68,92,55,77,63,67,51,38\r\n18,85,88,63,77,52,38,61,64\r\n89,83,99,88,55,15,78,77,68,72,87,18,91,85,67\r\n13,17,35,89,48,33,43,54,21,23,38,83,76\r\n36,25,56,96,89,17,81,21,83,24,14,52,22,92,99,88,51,15,78,77,68,72,87\r\n24,52,22,55,51,15,78,72,87,64,82,61,44\r\n55,15,78,87,18,85,63,71,38,97,54\r\n37,44,61,32,85,76,71,68,87\r\n23,65,89,56,33,21,37,22,48,17,96,25,92\r\n24,14,52,92,99,88,55,51,15,72,87,18,91,61,63\r\n24,14,22,92,99,88,51,15,78,68,72,87,18,85,64,82,61,63,44\r\n64,44,97,43,76,54,42,35,37,13,33,36,56\r\n15,87,91,67,82,61,97\r\n63,18,32,76,67,82,15,64,91,72,85,68,54,43,42,71,61,87,97,44,38,78,29\r\n48,33,25,56,96,89,81,21,14,52,22,92,99,88,55,51,15,78,77\r\n89,17,81,83,52,88,15,78,77,72,87\r\n51,55,92,77,88,72,68,24,87,89,85,99,52,14,83,81,21,91,15,17,22,18,96\r\n76,35,33,13,14,42,81,43,23,29,89,24,21,96,17,37,32,25,65\r\n89,25,13,56,78,15,92,48,17,23,88,99,14,51,52\r\n21,83,54,33,35,25,13,22,48,37,56,14,36,89,42\r\n61,71,29,37,13\r\n96,17,24,14,22,92,88,51,77,72,85\r\n99,88,55,51,77,68,72,87,18,91,85,82,61,63,71,38,97,43,76\r\n65,35,42,32,13,17,25,83,33,23,54,14,24\r\n76,54,87,72,61,18,97,91,44,42,65,85,82,71,77,35,29\r\n91,87,92,78,21,52,18,24,68,85,77,15,81,83,22,64,72,51,99,82,14,67,88\r\n43,32,35,37,13,96,17\r\n33,36,96,21,24,14,52,22,92\r\n77,83,92,85,81,91,21,68,24,64,82\r\n61,71,48,63,44,32,42,65,37,56,96,43,35,76,29,23,38\r\n44,71,38,54,32,35,13,33,23,56,96\r\n23,17,81,21,83,24,92,99,88,55,51,15,78,77,72\r\n42,33,61,67,23,64,25,65,82\r\n81,13,48,22,29,23,35,14,21,92,89\r\n33,23,36,25,56,96,17,81,21,83,24,14,52,22,92,99,88,55,51,15,78,77,68\r\n32,29,35,65,37,48,23,36,56,96,89,17,81,21,83,24,52,22,99\r\n65,37,13,25,96,89,17,21,92\r\n48,76,13,82,71,97,23,61,56,29,36,33,44,42,25,43,38,54,37,96,35\r\n21,99,61,87,68,22,88\r\n18,38,54,32,35,48,33\r\n97,63,55,78,15,77,68,87,61,18,38,51,71,91,88,99,92,22,44,85,82,67,64\r\n56,99,36,96,13\r\n56,25,43,76,23,33,64,29,36\r\n99,51,68,87,91,82,63,44,71,43,76\r\n82,54,85,91,29,64,33,61,42,37,97\r\n56,42,17,33,97,43,63\r\n77,17,21,99,52,85,15,91,78,88,14,67,51,24,92,22,64\r\n55,51,15,78,77,68,72,87,18,91,85,67,64,82,61,63,44,38,97,43,76,54,42\r\n87,78,67,18,42,61,55,82,91,71,85,97,15,72,43,76,63,44,64,38,54,77,51\r\n37,44,64,13,29,97,25,82,61,67,36,35,43,63,23\r\n33,23,25,56,96,89,17,21,83,14,52,22,92,99,88,51,78,77,68\r\n33,36,32,35,48,23,24,21,22,17,99,83,25,37,96,29,81,92,14,65,52\r\n76,32,71,42,33,82,97,36,54,44,35,13,29,43,37,63,48,96,65\r\n65,37,13,48,33,23,36,25,56,96,89,17,81,21,83,24,52,22,92,99,88,55,51\r\n42,32,29,35,37,13,48,23,36,56,96,21,83,14,52,22,92\r\n42,43,25,65,23,37,61,44,48,29,76,33,36,38,54,97,96,89,35\r\n52,99,55,51,78,18,64,82,63,71,38\r\n36,96,89,17,81,83,14,52,88,51,15,78,77\r\n96,81,51,15,99,37,24,36,13,17,33\r\n21,83,24,14,52,99,88,55,51,15,68,72,91,85,67,64,61\r\n25,51,81,22,99,56,18,52,78,14,87,92,15,77,68,83,55\r\n81,77,92,21,51,15,99,96,56\r\n71,43,65,82,54,42,13,36,25,61,23,33,35,63,67,38,76,97,37,32,29\r\n37,76,63,61,96,56,25,35,13,36,43,29,82,32,48,33,97\r\n35,52,23,14,96,42,89,21,81,83,76\r\n48,23,36,25,56,96,89,17,81,21,83,24,14,52,22,92,99,88,55,51,15,78,77\r\n44,61,85,92,91,77,15,64,51\r\n37,13,48,33,23,25,56,81,83,52,92,51,15\r\n56,78,96,88,92,36,23,17,25,52,48,99,24,89,55,21,15,81,51\r\n64,22,67,55,97,72,15,18,68,38,88\r\n85,64,68,44,54,87,76,91,82,63,88\r\n85,38,78,82,18,87,91,32,77,43,76,72,15,42,51\r\n22,92,88,72,87,91,67,82,61,44,97\r\n55,18,54,38,87,88,85,15,76\r\n83,24,14,52,22,92,88,55,51,15,78,77,68,72,18,91,85,67,64,61,63\r\n42,32,35,65,37,13,48,33,23,36,25,56,96,89,21,83,24,14,52,22,92\r\n32,17,29,83,48,14,21,25,52,42,96,33,37,65,76\r\n35,89,81,14,32,83,29,65,52,25,92,13,22,36,33,48,37,42,24\r\n81,42,35,36,89,54,71,25,32,43,76,37,38,44,65,23,17,33,56\r\n21,18,87,52,22,56,51,15,77,92,25,55,72,99,78,96,14,83,24\r\n56,25,37,81,38,89,21,43,65,83,33,36,35,96,48,42,29\r\n55,15,77,68,87,18,91,85,61,44,38,97,43,76,42\r\n22,99,72,83,67,52,61,21,68,14,87,18,77,51,64\r\n92,55,85,14,22,17,52,89,78\r\n88,68,18,14,81,22,91,52,83,99,72\r\n36,17,29,83,96,65,54,89,43,35,56,23,25,13,81,76,14\r\n88,51,78,63,43,76,54\r\n91,67,82,61,38,97,43,76,54,42,32,29,35,13,48,33,23\r\n67,63,35,71,54,68,37\r\n85,35,33,32,61,76,65,54,37,67,91,42,97,48,71,82,38,29,13,44,43\r\n77,15,81,89,96,25,14,92,78,22,51,24,21,83,56,18,88,99,68\r\n23,36,25,22,92,15,72\r\n23,25,54,36,65,17,14,76,56,96,35,48,81,24,37,21,89\r\n85,64,61,38,32,29,65\r\n56,89,17,24,14,92,99,55,78,18,91\r\n18,85,61,63,44,71,38,48,33\r\n81,21,14,52,92,88,72,67,82\r\n55,51,15,78,77,64,63,44,38,43,76,54,42\r\n76,54,48,23,96,81,83,24,52\r\n21,83,13,14,22,96,25,37,56,81,36,92,42,89,23,32,24,33,52,35,17\r\n42,13,91,38,43,82,35,18,87,29,37,85,64,67,54,32,63,76,72,61,44\r\n23,22,29,21,24,36,14,99,89,56,88\r\n77,56,15,33,48,24,81,22,92\r\n78,87,85,67,44,71,97,29,35\r\n61,15,78,63,77,71,44,68,91,87,32,85,72,43,76,82,29,97,42,54,18,38,67\r\n99,18,81,82,87,24,78,51,83\r\n54,65,48,36,14,52,22\r\n63,44,38,97,54,42,32,65,37,56,96,89,17\r\n83,88,68,72,81,52,55,36,25,22,17,92,87\r\n44,38,97,54,42,37,13,33,23,36,81\r\n61,18,67,64,38,35,65,85,68,29,37,63,71,42,91,82,97\r\n65,54,23,35,89,43,29,38,36,76,81,21,32,17,56,71,42\r\n96,78,55,91,17,77,85\r\n64,82,61,44,38,97,43,42,32,35,65,37,48,33,23\r\n23,36,25,56,89,17,81,21,83,14,52,22,92,99,88,55,51,15,78,68,72\r\n97,43,54,42,32,29,35,37,13,48,33,23,56,96,89,17,21,83,24\r\n54,65,36,23,71\r\n13,44,33,63,48,97,25,38,64,82,61,56,76,42,54,65,71,43,23,35,36,37,32\r\n65,13,48,23,36,56,89,21,52,22,88,55,51\r\n68,51,14,83,64,18,77,17,91\r\n76,37,38,25,13,33,71,21,42\r\n21,92,81,87,24,56,51\r\n48,83,35,37,81,97,89,54,33,29,36,13,96,23,38,21,65,17,76,56,32,43,25\r\n13,48,17,83,14,15,78\r\n18,22,92,82,68,87,24,52,44,99,67\r\n77,99,87,92,22,51,52,68,71,14,82\r\n22,67,83,63,14,15,82\r\n64,44,97,61,67,32,37,65,38,29,35,48,71,36,54,76,85\r\n24,14,92,99,15,78,87\r\n63,71,76,54,32,29,35,65,37,13,48,33,23,36,25,56,96,89,17\r\n42,96,71,35,25,65,23,33,44,81,32,97,29,76,13,54,43,56,17\r\n87,91,67,82,44,71,38,97,43,76,29,35,65,37,48\r\n33,38,13,48,65,43,61,82,37,76,54,32,35,44,67,29,85\r\n24,52,22,92,55,51,78,68,72,18,91,85,64,82,44\r\n63,48,85,67,38\r\n42,32,35,65,13,48,33,36,25,89,17,81,14\r\n63,44,71,43,35,65,37,13,23,36,17\r\n25,21,97,33,54,32,76,42,37,17,35,65,89,81,83,96,36,23,48,43,13,38,29\r\n42,32,29,35,65,37,33,25,56,89,17,21,24,14,52,22,92\r\n37,48,81,21,83,14,22,88,55,51,15\r\n55,51,77,68,87,18,91,85,67,82,63,44,38,97,54\r\n35,65,13,33,36\r\n61,48,44,64,43,36,82,42,56,29,23,54,33\r\n92,99,88,55,15,78,77,68,72,18,91,67,64,82,61,63,44,71,38,97,43\r\n32,29,33,23,96,83,22,92,99\r\n63,55,61,92,87,64,88,85,72\r\n67,92,77,64,52,51,81,91,17,85,21,22,14,78,15,88,18,72,83,55,68\r\n36,78,92,22,51,87,99\r\n37,13,36,56,81,92,88,55,15\r\n29,35,37,13,48,33,23,25,56,96,89,17,81,21,83,24,52,22,92,99,88";
            bool FirstPart = false;
            int z = 0;
            for (int i = 1; i <= str.Length - 1 && FirstPart == false; i++)
            {
                if (str[i] == '\r')
                {
                    int int1 = int.Parse(str.Substring(i - 5, 2));
                    int int2 = int.Parse(str.Substring(i - 2, 2));
                    if(dict.ContainsKey(int1))
                    {
                        dict[int1].Add(int2);
                    }
                    else
                    {
                        dict.Add(int1, new List<int> { int2 });
                    }
                }
                if(str.Substring(i,4) == "\r\n\r\n")
                {
                    FirstPart = true;
                    z = i + 4;
                }
            }
            char look = str[z];
            m_dict = dict;
            int aux = 0;
            for(int i = z; i < str.Length; i++ )
            {
                if (str[i] == '\r')
                {
                    bool Comma = true;
                    list.Add([]);
                    for (int j = 0; Comma == true; j++)
                    {
                        if (str[i-j] == ',')
                        {
                            list[aux].Insert(0,int.Parse(str.Substring(i - j + 1, 2)));
                        }
                        if (str[i-j] == '\n')
                        {
                            list[aux].Insert(0,int.Parse(str.Substring(i - j + 1, 2)));
                            Comma = false;
                        }
                    }
                    aux++;
                }
            }
            list.Add([29, 35, 37, 13, 48, 33, 23, 25, 56, 96, 89, 17, 81, 21, 83, 24, 52, 22, 92, 99, 88]);
            m_list = list;
        }
        public int star1()
        {
            int output = 0;
            List<int> Unstables = new List<int>();
            for(int i = 0; i < m_list.Count ; i++)
            {
                bool Stable = true;
                for (int j = 0; j < m_list[i].Count; j++)
                {
                    List<int> predecessors = m_dict[m_list[i][j]];
                    List<int> actualpred = new List <int>();
                    for(int k = 0 ; k < j; k++ )
                    {
                        actualpred.Add(m_list[i][k]);
                    }
                    for(int k = 0; k < actualpred.Count && Stable == true; k++)
                    {
                        if (predecessors.Contains(actualpred[k]))
                        {
                            Unstables.Add(i);
                            Stable = false;
                        }
                    }
                }
            }
            for(int i = 0; i < m_list.Count; i++)
            {
                if(!Unstables.Contains(i))
                {
                    output += m_list[i][m_list[i].Count / 2];
                }
            }
            m_WrongOrder = Unstables;
            return output;
        }
        public int star2()
        {
            int output = 0;
            foreach(int i in m_WrongOrder)
            {
                bool Stable = true;
                for (int j = 0; j < m_list[i].Count; j++)
                {
                    List<int> predecessors = m_dict[m_list[i][j]];
                    List<int> actualpred = new List<int>();
                    for (int k = 0; k < j; k++)
                    {
                        actualpred.Add(m_list[i][k]);
                    }
                    for (int k = 0; k < actualpred.Count && Stable == true; k++)
                    {
                        if (predecessors.Contains(actualpred[k]))
                        {
                            int temp = m_list[i][j];
                            m_list[i][j] = m_list[i][k];
                            m_list[i][k] = temp;
                        }
                    }
                }
            }
            foreach (int i in m_WrongOrder)
            {
                output += m_list[i][m_list[i].Count / 2];
            }
            return output;
        }
    }
}
